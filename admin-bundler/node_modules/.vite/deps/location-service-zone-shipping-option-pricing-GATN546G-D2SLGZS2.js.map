{
  "version": 3,
  "sources": ["../../../../dashboard/dist/location-service-zone-shipping-option-pricing-GATN546G.mjs"],
  "sourcesContent": ["import {\n  useShippingOptionPriceColumns\n} from \"./chunk-NWJKUZS5.mjs\";\nimport {\n  DataGrid\n} from \"./chunk-R5UFUQNC.mjs\";\nimport \"./chunk-MWVM4TYO.mjs\";\nimport {\n  castNumber\n} from \"./chunk-6GU6IDUA.mjs\";\nimport \"./chunk-MGS2W2HU.mjs\";\nimport \"./chunk-OC7BQLYI.mjs\";\nimport \"./chunk-XDUX5ONP.mjs\";\nimport \"./chunk-ZHSZGFLW.mjs\";\nimport {\n  RouteFocusModal,\n  useRouteModal\n} from \"./chunk-RLLZZQKN.mjs\";\nimport \"./chunk-C7RYT3S3.mjs\";\nimport {\n  useShippingOption,\n  useUpdateShippingOptions\n} from \"./chunk-CH64NKU5.mjs\";\nimport \"./chunk-G3GT763I.mjs\";\nimport {\n  useStore\n} from \"./chunk-HULOFXB4.mjs\";\nimport {\n  useRegions\n} from \"./chunk-CELPQCSR.mjs\";\nimport {\n  usePricePreferences\n} from \"./chunk-7FQQ2EGV.mjs\";\nimport \"./chunk-2T3PD3VS.mjs\";\nimport \"./chunk-OEVIH5XG.mjs\";\nimport \"./chunk-GPBQTNZI.mjs\";\nimport \"./chunk-PWWSB76U.mjs\";\nimport \"./chunk-GH77ZQI2.mjs\";\n\n// src/routes/locations/location-service-zone-shipping-option-pricing/location-service-zone-shipping-option-pricing.tsx\nimport { json, useParams } from \"react-router-dom\";\n\n// src/routes/locations/location-service-zone-shipping-option-pricing/components/create-shipping-options-form/edit-shipping-options-pricing-form.tsx\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { useMemo } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport * as zod from \"zod\";\nimport { Button, toast } from \"@medusajs/ui\";\nimport { useTranslation } from \"react-i18next\";\nimport { jsx, jsxs } from \"react/jsx-runtime\";\nvar getInitialCurrencyPrices = (prices) => {\n  const ret = {};\n  prices.forEach((p) => {\n    if (p.price_rules.length) {\n      return;\n    }\n    ret[p.currency_code] = p.amount;\n  });\n  return ret;\n};\nvar getInitialRegionPrices = (prices) => {\n  const ret = {};\n  prices.forEach((p) => {\n    if (p.price_rules.length) {\n      const regionId = p.price_rules[0].value;\n      ret[regionId] = p.amount;\n    }\n  });\n  return ret;\n};\nvar EditShippingOptionPricingSchema = zod.object({\n  region_prices: zod.record(\n    zod.string(),\n    zod.string().or(zod.number()).optional()\n  ),\n  currency_prices: zod.record(\n    zod.string(),\n    zod.string().or(zod.number()).optional()\n  )\n});\nfunction EditShippingOptionsPricingForm({\n  shippingOption\n}) {\n  const { t } = useTranslation();\n  const { handleSuccess } = useRouteModal();\n  const form = useForm({\n    defaultValues: {\n      region_prices: getInitialRegionPrices(shippingOption.prices),\n      currency_prices: getInitialCurrencyPrices(shippingOption.prices)\n    },\n    resolver: zodResolver(EditShippingOptionPricingSchema)\n  });\n  const { mutateAsync, isPending } = useUpdateShippingOptions(shippingOption.id);\n  const {\n    store,\n    isLoading: isStoreLoading,\n    isError: isStoreError,\n    error: storeError\n  } = useStore();\n  const currencies = useMemo(\n    () => store?.supported_currencies?.map((c) => c.currency_code) || [],\n    [store]\n  );\n  const {\n    regions,\n    isLoading: isRegionsLoading,\n    isError: isRegionsError,\n    error: regionsError\n  } = useRegions({\n    fields: \"id,name,currency_code\",\n    limit: 999\n  });\n  const { price_preferences: pricePreferences } = usePricePreferences({});\n  const { setCloseOnEscape } = useRouteModal();\n  const columns = useShippingOptionPriceColumns({\n    currencies,\n    regions,\n    pricePreferences\n  });\n  const data = useMemo(\n    () => [[...currencies || [], ...regions || []]],\n    [currencies, regions]\n  );\n  const handleSubmit = form.handleSubmit(async (data2) => {\n    const currencyPrices = Object.entries(data2.currency_prices).map(([code, value]) => {\n      if (value === \"\" || value === void 0) {\n        return void 0;\n      }\n      const currencyExists = currencies.some((currencyCode) => currencyCode.toLowerCase() == code.toLowerCase());\n      if (!currencyExists) {\n        return void 0;\n      }\n      const amount = castNumber(value);\n      const priceRecord = {\n        currency_code: code,\n        amount\n      };\n      const price = shippingOption.prices.find(\n        (p) => p.currency_code === code && !p.price_rules.length\n      );\n      if (price) {\n        priceRecord[\"id\"] = price.id;\n      }\n      return priceRecord;\n    }).filter((p) => !!p);\n    const regionPrices = Object.entries(data2.region_prices).map(([region_id, value]) => {\n      if (value === \"\" || value === void 0) {\n        return void 0;\n      }\n      const regionExists = regions?.some((region) => region.id === region_id);\n      if (!regionExists) {\n        return void 0;\n      }\n      const amount = castNumber(value);\n      const priceRecord = {\n        region_id,\n        amount\n      };\n      return priceRecord;\n    }).filter((p) => !!p);\n    await mutateAsync(\n      {\n        prices: [...currencyPrices, ...regionPrices]\n      },\n      {\n        onSuccess: () => {\n          toast.success(t(\"general.success\"));\n          handleSuccess();\n        },\n        onError: (e) => {\n          toast.error(e.message);\n        }\n      }\n    );\n  });\n  const isLoading = isStoreLoading || isRegionsLoading || !currencies || !regions;\n  if (isStoreError) {\n    throw storeError;\n  }\n  if (isRegionsError) {\n    throw regionsError;\n  }\n  return /* @__PURE__ */ jsx(RouteFocusModal.Form, { form, children: /* @__PURE__ */ jsxs(\n    \"form\",\n    {\n      className: \"flex h-full flex-col overflow-hidden\",\n      onSubmit: handleSubmit,\n      children: [\n        /* @__PURE__ */ jsx(RouteFocusModal.Header, {}),\n        /* @__PURE__ */ jsx(RouteFocusModal.Body, { children: /* @__PURE__ */ jsx(\"div\", { className: \"flex size-full flex-col divide-y overflow-hidden\", children: /* @__PURE__ */ jsx(\n          DataGrid,\n          {\n            isLoading,\n            data,\n            columns,\n            state: form,\n            onEditingChange: (editing) => setCloseOnEscape(!editing)\n          }\n        ) }) }),\n        /* @__PURE__ */ jsx(RouteFocusModal.Footer, { children: /* @__PURE__ */ jsxs(\"div\", { className: \"flex items-center justify-end gap-x-2\", children: [\n          /* @__PURE__ */ jsx(RouteFocusModal.Close, { asChild: true, children: /* @__PURE__ */ jsx(Button, { variant: \"secondary\", size: \"small\", children: t(\"actions.cancel\") }) }),\n          /* @__PURE__ */ jsx(\n            Button,\n            {\n              size: \"small\",\n              className: \"whitespace-nowrap\",\n              isLoading: isPending,\n              onClick: handleSubmit,\n              type: \"button\",\n              children: t(\"actions.save\")\n            }\n          )\n        ] }) })\n      ]\n    }\n  ) });\n}\n\n// src/routes/locations/location-service-zone-shipping-option-pricing/location-service-zone-shipping-option-pricing.tsx\nimport { jsx as jsx2 } from \"react/jsx-runtime\";\nfunction LocationServiceZoneShippingOptionPricing() {\n  const { so_id, location_id } = useParams();\n  if (!so_id) {\n    throw json({\n      message: \"Shipping Option ID paramater is missing\",\n      status: 404\n    });\n  }\n  const { shipping_option: shippingOption, isError, error } = useShippingOption(so_id, {\n    fields: \"*prices,*prices.price_rules\"\n  });\n  if (isError) {\n    throw error;\n  }\n  return /* @__PURE__ */ jsx2(RouteFocusModal, { prev: `/settings/locations/${location_id}`, children: shippingOption && /* @__PURE__ */ jsx2(EditShippingOptionsPricingForm, { shippingOption }) });\n}\nexport {\n  LocationServiceZoneShippingOptionPricing as Component\n};\n"],
  "mappings": "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",
  "names": ["import_jsx_runtime", "t", "jsx2"]
}
